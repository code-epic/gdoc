<ngx-ui-loader [loaderId]="'loader-buscar'"></ngx-ui-loader>


<div class="card-body">
    <form>
        <div class="row" *ngIf="bSecretaria">
            <div class="form-group  col-md-6">
                <label>Unidad Minsiterial</label>
                <input type="text" class="form-control" [ngModelOptions]="{standalone: true}" [(ngModel)]="unidad"
                    value="{{unidad}}" readonly>
            </div>
            <div class="form-group  col-md-3">
                <label>N. De Cuenta</label>
                <input type="text" class="form-control" [ngModelOptions]="{standalone: true}" [(ngModel)]="cuenta"
                    value="{{cuenta}}" readonly>
            </div>
            <div class="form-group  col-md-3">
                <label>Fecha</label>
                <input type="text" class="form-control" [ngModelOptions]="{standalone: true}" [(ngModel)]="fecha"
                    value="{{fecha}}" readonly>
            </div>
            
        </div>
        <div class="row" *ngIf="bSecretaria">
            <div class="form-group col-md-12">
                <label>Cuenta o oficio</label>
                <textarea class="form-control" cols="30" rows="4" [ngModelOptions]="{standalone: true}"
                        [(ngModel)]="asunto" placeholder="Introduzca el asunto..."
                        style="width: 100%">{{asunto}}</textarea>
            </div>

        </div>
        


        <div class="row">
            <div class="form-group col-md-3">
                <mat-form-field appearance="outline">
                    <mat-label>Cédula</mat-label>
                    <input matInput placeholder="Cédula" [ngModelOptions]="{standalone: true}"
                        [(ngModel)]="Resolucion.cedula" value="{{Resolucion.cedula}}" (blur)="consultarCedula()">
                    <mat-icon matSuffix *ngIf="!editar_datos">person_search</mat-icon>
                    <mat-icon matSuffix *ngIf="editar_datos" (click)="Seleccionar()"
                        class="text-blue">person_search</mat-icon>
                </mat-form-field>
            </div>
            <div class="form-group col-md-3">
                <mat-form-field appearance="outline">
                    <mat-label>Grado</mat-label>

                    <input matInput placeholder="Nombre completo" [ngModelOptions]="{standalone: true}"
                        [(ngModel)]="Resolucion.gran_comando" value="{{Resolucion.gran_comando}}"
                        disabled="disabled">

                </mat-form-field>
            </div>
            <div class="form-group col-md-6">
                <mat-form-field appearance="outline">
                    <mat-label>Nombre completo</mat-label>

                    <input matInput placeholder="Nombre completo" [ngModelOptions]="{standalone: true}"
                        [(ngModel)]="Resolucion.nombres" value="{{Resolucion.nombres}}" disabled="disabled">

                </mat-form-field>



            </div>
        </div>



        <div class="row">

            <div class="col-md-12" style="padding: 15px; margin-top:-40px">
                <table summary="" class="table table-bordered table-hover" style="width: 100%; word-break : break-word;">

                    <thead>
                        <tr [ngStyle]="{'background-color': color}">
                            <th style="text-align: center;">COMPONENTE</th>
                            <th style="text-align: center;">CATEGORIA</th>
                            <th style="text-align: center;">CLASIFICACION</th>
                            <th style="text-align: center;">SITUACION</th>
                        </tr>
                        <tr>
                            <th style="text-align: center;">{{Resolucion.componente}}</th>
                            <th style="text-align: center;">{{Resolucion.categoria}}</th>
                            <th style="text-align: center;">{{Resolucion.clasificacion}}</th>
                            <th style="text-align: center;"></th>
                        </tr>
                        <tr>
                            <th colspan="4">&Uacute;ltima resoluci&oacute;n: {{ nombramiento }}</th>
                        </tr>
                        <tr>
                            <td colspan="4" style="width: 100%; word-break : break-word;" [innerHTML]="xasunto | uppercase">

                            </td>
                        </tr>
                    </thead>
                </table>
            </div>


        </div>




       
    </form>
</div>



<br>
<div class="row">
    <div class="col-md-12">
        <div class="card">
            <div class="card-body">

                <div class="form-row">
                    <div class="col-md-3">
                        <mat-form-field class="example-full-width" appearance="outline" style="width:100%">
                            <mat-label>Formato del Documento</mat-label>
                            <mat-select placeholder="Documento" [ngModelOptions]="{standalone: true}"
                                [(ngModel)]="Resolucion.tipo">
                                <mat-option value="0">RESOLUCION</mat-option>
                                <mat-option value="1">ORDEN GENERAL</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>

                    

                    <div class="form-group col-md-6">
                        <mat-form-field class="example-full-width" appearance="outline" style="width:100%">
                            <mat-label style="width:100%">Tipo de Resolución</mat-label>
                            <input type="text" matInput [formControl]="myControl" [matAutocomplete]="auto"
                            (blur)="seleccionTipo()" [(ngModel)]="tipo">
                            <mat-autocomplete #auto="matAutocomplete" [displayWith]="displayFn" style="width:100%">
                                <mat-option *ngFor="let option of filteredOptions | async" [value]="option">
                                    {{option.nombre}}
                                </mat-option>
                            </mat-autocomplete>
                            <mat-icon matSuffix>search</mat-icon>
                        </mat-form-field>
                    </div>

                    <div class="col-md-3">
                        <mat-form-field class="example-full-width" appearance="outline" style="width:100%">
                            <mat-label style="width:100%">Número</mat-label>

                            <input matInput placeholder="Seleccionar unidad" [ngModelOptions]="{standalone: true}"
                                [(ngModel)]="Resolucion.numero" value="{{Resolucion.numero}}">
                            <mat-icon matSuffix >folder</mat-icon>

                        </mat-form-field>
                    </div>
                    
                </div>
                <div class="form-row">

                    

                    <!-- <div class="form-group col-md-4">
                        <mat-form-field class="example-full-width" appearance="fill" style="width:100%">
                            <mat-label>Número de Resolución </mat-label>
                            <input matInput placeholder="" [ngModelOptions]="{standalone: true}"
                                [(ngModel)]="Resolucion.numero" value="{{Resolucion.numero}}">
                        </mat-form-field>
                    </div>
                    <div class="form-group col-md-6">
                        <mat-form-field class="example-full-width" appearance="fill" style="width:100%">
                            <mat-label style="width:100%">Tipo de Resolución</mat-label>
                            <input type="text" matInput [formControl]="myControl" [matAutocomplete]="auto">
                            <mat-autocomplete #auto="matAutocomplete" [displayWith]="displayFn" style="width:100%">
                                <mat-option *ngFor="let option of filteredOptions | async" [value]="option">
                                    {{option.des_resol}}
                                </mat-option>
                            </mat-autocomplete>
                        </mat-form-field>
                    </div>
                    <div class="form-group col-md-2">
                        <mat-form-field class="example-full-width" appearance="fill" style="width:100%">
                            <mat-label>Número Carpeta </mat-label>
                            <input matInput placeholder="" [ngModelOptions]="{standalone: true}"
                                [(ngModel)]="Resolucion.carpeta" value="{{Resolucion.carpeta}}">
                        </mat-form-field>
                    </div> -->
                </div>



                <div class="form-row">
                    <div class="form-group col-md-12">
                        <label for="txtObjeto">Asunto</label>
                        <textarea class="form-control" cols="30" rows="3" [ngModelOptions]="{standalone: true}"
                                [(ngModel)]="Resolucion.asunto" placeholder="Introduzca el asunto..."
                                style="width: 100%">{{Resolucion.asunto}}</textarea>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group col-md-12">
                        <label for="txtObjeto">Observaciones</label>
                        <!-- <div class="NgxEditor__Wrapper">
                            <angular-editor [placeholder]="'Enter text here...'"
                                [(ngModel)]="Resolucion.observacion"></angular-editor>
                        </div> -->
                        <textarea class="form-control" cols="30" rows="3" [ngModelOptions]="{standalone: true}"
                                [(ngModel)]="Resolucion.observacion" placeholder="Introduzca el asunto..."
                                style="width: 100%">{{Resolucion.observacion}}</textarea>
                    </div>
                </div>


                <div class="form-row">
                    <div class="col-md-4">
                        <mat-form-field class="example-full-width" appearance="outline" style="width:100%">
                            <mat-label>Estatus</mat-label>
                            <mat-select placeholder="Documento" [ngModelOptions]="{standalone: true}"
                                [(ngModel)]="Resolucion.estatus">
                                <mat-option *ngFor="let e of Estados;" [value]="e.cod_estado_resol">{{e.des_estado_resol}}</mat-option>
                                
                            </mat-select>
                        </mat-form-field>
                    </div>
                    <div class="form-group col-md-8" style="padding-top:5px ;">
                        <form method="post" enctype="multipart/form-data" id="forma" name="forma">
                            <input type="hidden" name="identificador" value="{{hashcontrol}}" readonly="readonly" >
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="input_container">
                                        <input style="height: 48px;" (change)="fileSelected($event)" id="fileUpload" type="file"
                                            name="archivos" accept=".pdf" />

                                    </div>
                                </div>
                                <!-- <div class="col-md-3">
                                        <button class="btn bg-success text-white ">
                                            <span class="fa fa-upload"></span>&nbsp;&nbsp;Enviar
                                            Archivos </button>
                                    </div> -->
                            </div>
                        </form>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-12">
                        <div class="text-right">
                            <button class="btn bg-primary text-white" (click)="guardar()">Aceptar</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Fin de Tarjeta Padre -->





<!-- Adjuntar Imagenes al Documento -->
<ng-template #archivos let-modal>
    <div class="modal-header header bg-gradient-success">
        <h4 class="modal-title" id="modal-basic-title">Lista de Archivos asociados {{ numControl }}</h4>

    </div>
    <div class="modal-body">


        <div class="form-group col-md-12">
            <div class="card card-profile">
                <div class="card-header bg-info"
                    style="background-image: url('./assets/img/theme/inn.svg'); height: 80px;">
                    <div class="card-avatar text-center">
                        <a href="javascript:;">
                            <img class="img img-raised rounded-circle" src="./assets/img/theme/pdf2.jpeg"
                                style="width:100px;z-index: 1; margin-top: -5px;">3
                        </a>
                    </div>
                </div>
                <br>

                <div class="card-body pt-0">

                    <div class="d-flex justify-content-between">
                        <a [href]="download" target="_top" rel="noopener noreferrer"
                            class="btn btn-primary mt-3">Descargar</a>
                        <a (click)="activarHistorial()" class="btn btn-default float-right mt-3">Historial</a>
                    </div>
                    <br><br>
                    <div class="text-center">
                        <div class="font-weight-50">
                            Publicado<span class="font-weight-light">, {{ Doc.fcreacion | date:"dd-MM-yy
                                hh:mm:ss"}}</span>
                            <br>
                            <h5 class="h4" style="font-size: 10px;">{{ Doc.creador }}</h5>
                        </div>
                    </div>
                    <div style="margin-left: -10px;height:300px;overflow-x:scroll;width:104%" *ngIf="bHist">
                        <table class="table">
                            <thead class="thead-light">
                                <th>Documento</th>
                                <th>Usuario</th>
                                <th>Fecha</th>
                            </thead>
                            <tbody>

                                <tr [ngModelOptions]="{standalone: true}" *ngFor="let el of lstHzAdjunto;let i=index">

                                    <td>
                                        <a [href]="dwUrl(Doc.ncontrol, el.nombre)" target="_top"
                                            rel="noopener noreferrer">
                                            {{ el.nombre.substring(20,32) }}
                                        </a>
                                    </td>
                                    <td>{{ el.usuario }}</td>
                                    <td>{{ el.fecha | date:"dd/MM/yy hh:mm:ss"}}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <button class="btn btn-warning" aria-label="Close" (click)="modal.dismiss('Close')">
            <span class="fa fa-times"></span>&nbsp;&nbsp;Cancelar</button>
    </div>
</ng-template>