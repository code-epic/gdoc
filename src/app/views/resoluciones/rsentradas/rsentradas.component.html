<ngx-ui-loader [loaderId]="'loader-entrada'"></ngx-ui-loader>


<div class="card-body">
    <form>
        <div class="row" *ngIf="bSecretaria">
            <div class="form-group  col-md-6">
                <label>Unidad Minsiterial</label>
                <input type="text" class="form-control" [ngModelOptions]="{standalone: true}" [(ngModel)]="unidad"
                    value="{{unidad}}" readonly>
            </div>
            <div class="form-group  col-md-3">
                <label>N. De Cuenta</label>
                <input type="text" class="form-control" [ngModelOptions]="{standalone: true}" [(ngModel)]="cuenta"
                    value="{{cuenta}}" readonly>
            </div>
            <div class="form-group  col-md-3">
                <label>Fecha</label>
                <input type="text" class="form-control" [ngModelOptions]="{standalone: true}" [(ngModel)]="fecha"
                    value="{{fecha}}" readonly>
            </div>

        </div>
        <div class="row" *ngIf="bSecretaria">
            <div class="form-group col-md-12">
                <label>Cuenta o oficio</label>
                <textarea class="form-control" cols="30" rows="4" [ngModelOptions]="{standalone: true}"
                    [(ngModel)]="asunto" placeholder="Introduzca el asunto..." style="width: 100%">{{asunto}}</textarea>
            </div>

        </div>



        <div class="row">
            <div class="form-group col-md-3">
                <mat-form-field appearance="outline">
                    <mat-label>Cédula</mat-label>
                    <input matInput placeholder="Cédula" [ngModelOptions]="{standalone: true}"
                        [(ngModel)]="Resolucion.cedula" value="{{Resolucion.cedula}}" (blur)="consultarCedula()">
                    <mat-icon matSuffix *ngIf="!editar_datos">person_search</mat-icon>
                    <mat-icon matSuffix *ngIf="editar_datos" (click)="Seleccionar()"
                        class="text-blue">person_search</mat-icon>
                </mat-form-field>
            </div>
            <div class="form-group col-md-3">
                <mat-form-field appearance="outline">
                    <mat-label>Grado</mat-label>

                    <input matInput placeholder="Nombre completo" [ngModelOptions]="{standalone: true}"
                        [(ngModel)]="Resolucion.gran_comando" value="{{Resolucion.gran_comando}}" disabled="disabled">

                </mat-form-field>
            </div>
            <div class="form-group col-md-6">
                <mat-form-field appearance="outline">
                    <mat-label>Nombre completo</mat-label>

                    <input matInput placeholder="Nombre completo" [ngModelOptions]="{standalone: true}"
                        [(ngModel)]="Resolucion.nombres" value="{{Resolucion.nombres}}" disabled="disabled">

                </mat-form-field>



            </div>
        </div>



        <div class="row">

            <div class="col-md-12" style="padding: 15px; margin-top:-40px">
                <table summary="" class="table table-bordered table-hover"
                    style="width: 100%; word-break : break-word;">

                    <thead>
                        <tr [ngStyle]="{'background-color': color}">
                            <th style="text-align: center;">COMPONENTE</th>
                            <th style="text-align: center;">CATEGORIA</th>
                            <th style="text-align: center;">CLASIFICACION</th>
                            <th style="text-align: center;">SITUACION</th>
                        </tr>
                        <tr>
                            <th style="text-align: center;">{{Resolucion.componente}}</th>
                            <th style="text-align: center;">{{Resolucion.categoria}}</th>
                            <th style="text-align: center;">{{Resolucion.clasificacion}}</th>
                            <th style="text-align: center;">{{ getSituation(Resolucion.situacion) }}</th>
                        </tr>
                        <tr>
                            <th colspan="4">&Uacute;ltima resoluci&oacute;n: {{ nombramiento }}</th>
                        </tr>
                        <tr>
                            <td colspan="4" style="width: 100%; word-break : break-word;"
                                [innerHTML]="xasunto | uppercase">

                            </td>
                        </tr>
                    </thead>
                </table>
            </div>


        </div>




        <br>




        <div class="form-row">
            <div class="col-md-3">
                <mat-form-field class="example-full-width" appearance="outline" style="width:100%">
                    <mat-label>Formato del Documento</mat-label>
                    <mat-select placeholder="Documento"  [(value)]="codigo"
                        required="required">
                        <mat-option value="1">RESOLUCION</mat-option>
                        <mat-option value="0">ORDEN GENERAL</mat-option>
                    </mat-select>
                </mat-form-field>
            </div>


            <div class="col-md-3">
                <mat-form-field class="example-full-width" appearance="outline" style="width:100%">
                    <mat-label>Fecha (*)</mat-label>
                    <input matInput placeholder="Fecha " [ngModelOptions]="{standalone: true}"
                        ngbDatepicker #fo="ngbDatepicker" [placement]="placement" [positionTarget]="buttonEl"
                        [(ngModel)]="fecha_resolucion">
                    <mat-icon matSuffix #buttonEl (click)="fo.toggle()" type="button"
                        id="fori">edit_calendar</mat-icon>


                </mat-form-field>
            </div>
            

            <div class="col-md-3">
                <mat-form-field class="example-full-width" appearance="outline" style="width:100%">
                    <mat-label style="width:100%">Carpeta Número</mat-label>

                    <input matInput placeholder="Carpeta Número" [ngModelOptions]="{standalone: true}"
                        [(ngModel)]="Entradas.numero_carpeta" value="{{Entradas.numero_carpeta}}" required="required">

                </mat-form-field>
            </div>

            <div class="form-group col-md-3">
                
                <mat-form-field  class="example-full-width" appearance="outline" style="width:100%">
                    <mat-label style="width:100%">Cuenta</mat-label>
                    <input  type="text" matInput  
                    [ngModelOptions]="{standalone: true}" [(ngModel)]="Entradas.cuenta" value="{{Entradas.cuenta}}" >
                </mat-form-field>
            </div>


            <div class="col-md-4">
                <mat-form-field class="example-full-width" appearance="outline" style="width:100%">
                    <mat-label>Componente</mat-label>
                    <mat-select placeholder="Componente" [ngModelOptions]="{standalone: true}" 
                    [(ngModel)]="xcomponente" value="{{xcomponente}}"
                        required="required">
                        <mat-option *ngFor="let e of Componentes;"
                            [value]="e.cod_componente">{{e.nombre_componente}}</mat-option>
                    </mat-select>
                </mat-form-field>
            </div>



            <div class="form-group col-md-5">
                <mat-form-field *ngIf="bclasificacion" class="example-full-width" appearance="outline" style="width:100%">
                    <input readonly="readonly" type="text" matInput (click)="activar()" [(ngModel)]="xclasificacion">
                </mat-form-field>
                <mat-form-field *ngIf="!bclasificacion" class="example-full-width" appearance="outline" style="width:100%">
                    <mat-label style="width:100%">Clasificacion de documento</mat-label>
                    <input type="text" matInput [formControl]="myControl" [matAutocomplete]="auto"
                        (blur)="seleccionTipo()" [(ngModel)]="clasificacion">
                    <mat-autocomplete #auto="matAutocomplete" [displayWith]="displayFn" style="width:100%">
                        <mat-option *ngFor="let option of filteredOptions | async" [value]="option" required="required">
                            {{option.nombre}}
                        </mat-option>
                    </mat-autocomplete>
                    <mat-icon matSuffix>search</mat-icon>
                </mat-form-field>
            </div>

            <div class="col-md-3">
                <mat-form-field class="example-full-width" appearance="outline" style="width:100%">
                    <mat-label>Estatus</mat-label>
                    <mat-select placeholder="Estatus"  required="required" [(value)]="estatus">
                        <mat-option *ngFor="let e of Estados;"
                            [value]="e.cod_estado_resol">{{e.des_estado_resol}}</mat-option>

                    </mat-select>
                </mat-form-field>
            </div>


        </div>


        <div class="form-row">
            <div class="form-group col-md-12">
                <textarea class="form-control" cols="30" rows="2" [ngModelOptions]="{standalone: true}"
                    [(ngModel)]="Entradas.asunto" placeholder="Introduzca el asunto..." style="width: 100%"
                    required="required">{{Entradas.asunto}}</textarea>
            </div>
        </div>

        <div class="form-row">
            <div class="form-group col-md-12">
                <textarea class="form-control" cols="30" rows="2" [ngModelOptions]="{standalone: true}"
                    [(ngModel)]="Entradas.observacion" placeholder="Introduzca las observaciones..."
                    style="width: 100%">{{Entradas.observacion}}</textarea>
            </div>
        </div>


        <div class="form-row">
            
            <div class="col-md-5">
                <mat-form-field class="example-full-width" appearance="outline" style="width:100%">
                    <mat-label>Responsable</mat-label>
                    <mat-select placeholder="Responsable" [(ngModel)]="responsable">
                        <mat-option value="0">TRANSCRIPCION</mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
            <div class="form-group col-md-7" style="padding-top:5px ;">
                <form method="post" enctype="multipart/form-data" id="forma" name="forma">
                    <input type="hidden" name="identificador" value="{{hashcontrol}}" readonly="readonly">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="input_container">
                                <input style="height: 48px;" (change)="fileSelected($event)" id="fileUpload" type="file"
                                    name="archivos" accept=".pdf" />

                            </div>
                        </div>
                        <!-- <div class="col-md-3">
                                        <button class="btn bg-success text-white ">
                                            <span class="fa fa-upload"></span>&nbsp;&nbsp;Enviar
                                            Archivos </button>
                                    </div> -->
                    </div>
                </form>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <div class="text-right">
                    <button *ngIf="!editar && blAceptar" class="btn bg-primary text-white" (click)="SubirArchivo()">Aceptar</button>
                    <button *ngIf="editar && blAceptar" class="btn bg-warning text-white" (click)="SubirArchivo()">Actualizar</button>
                </div>
            </div>
        </div>

        <!-- Fin de Tarjeta Padre -->
    </form>
</div>



<!-- Adjuntar Imagenes al Documento -->
<ng-template #archivos let-modal>
    <div class="modal-header header bg-gradient-success">
        <h4 class="modal-title" id="modal-basic-title">Lista de Archivos asociados {{ numControl }}</h4>

    </div>
    <div class="modal-body">


        <div class="form-group col-md-12">
            <div class="card card-profile">
                <div class="card-header bg-info"
                    style="background-image: url('./assets/img/theme/inn.svg'); height: 80px;">
                    <div class="card-avatar text-center">
                        <a href="javascript:;">
                            <img class="img img-raised rounded-circle" src="./assets/img/theme/pdf2.jpeg"
                                style="width:100px;z-index: 1; margin-top: -5px;">3
                        </a>
                    </div>
                </div>
                <br>

                <div class="card-body pt-0">

                    <div class="d-flex justify-content-between">
                        <a [href]="download" target="_top" rel="noopener noreferrer"
                            class="btn btn-primary mt-3">Descargar</a>
                        <a (click)="activarHistorial()" class="btn btn-default float-right mt-3">Historial</a>
                    </div>
                    <br><br>
                    <div class="text-center">
                        <div class="font-weight-50">
                            Publicado<span class="font-weight-light">, {{ Doc.fcreacion | date:"dd-MM-yy
                                hh:mm:ss"}}</span>
                            <br>
                            <h5 class="h4" style="font-size: 10px;">{{ Doc.creador }}</h5>
                        </div>
                    </div>
                    <div style="margin-left: -10px;height:300px;overflow-x:scroll;width:104%" *ngIf="bHist">
                        <table class="table">
                            <thead class="thead-light">
                                <th>Documento</th>
                                <th>Usuario</th>
                                <th>Fecha</th>
                            </thead>
                            <tbody>

                                <tr [ngModelOptions]="{standalone: true}" *ngFor="let el of lstHzAdjunto;let i=index">

                                    <td>
                                        <a [href]="dwUrl(Doc.ncontrol, el.nombre)" target="_top"
                                            rel="noopener noreferrer">
                                            {{ el.nombre.substring(20,32) }}
                                        </a>
                                    </td>
                                    <td>{{ el.usuario }}</td>
                                    <td>{{ el.fecha | date:"dd/MM/yy hh:mm:ss"}}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <button class="btn btn-warning" aria-label="Close" (click)="modal.dismiss('Close')">
            <span class="fa fa-times"></span>&nbsp;&nbsp;Cancelar</button>
    </div>
</ng-template>